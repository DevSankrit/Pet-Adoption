<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Manage Pets</title>
  <link rel="stylesheet" href="dashboardcss.css">
  <link rel="stylesheet" href="managepets.css">
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  
  <style>
    /* General Button Styles */
    .icon-button {
      background-color: transparent;
      border: none;
      cursor: pointer;
      outline: none;
      transition: transform 0.3s ease, color 0.3s ease;
    }

    .icon-button:hover {
      color: #f39c12; /* Golden color on hover */
      transform: scale(1.1); /* Slightly enlarge the icon */
    }

    .icon-button i {
      font-size: 24px; /* Set the size of the Font Awesome icon */
      color: #333; /* Default color */
      transition: color 0.3s ease; /* Smooth transition for color */
    }

    /* Hover effect: Change the color when hovered */
    .icon-button:hover i {
      color: #e74c3c; /* Change to red on hover */
    }

    /* Optional - Make the button center-aligned */
    .table-actions {
      display: flex;
      justify-content: center;
      align-items: center;
    }
  </style>
</head>

<body>
  <div class="container">
    <aside>
      <div class="top">
        <div class="logo">
          <h2>RESCUE <span class="primary">HEARTS</span>‚ù§</h2>
        </div>
        <div class="close" id="close-btn">
          <span class="material-symbols-outlined"> close </span>
        </div>
      </div>

      <div class="sidebar">
        <a href="/dashboard">
          <span class="material-symbols-outlined"> grid_view </span>
          <h3>Dashboard</h3>
        </a>

        <a href="/addpet">
          <span class="material-symbols-outlined"> person_outline </span>
          <h3>Add Pet</h3>
        </a>

        <a href="/managepets" class="active">
          <span class="material-symbols-outlined"> insights </span>
          <h3>Manage Pets</h3>
        </a>

        <a href="/report">
          <span class="material-symbols-outlined"> report_gmailerrorred </span>
          <h3>Reports</h3>
        </a>

        <a href="" id="logout-link">
          <span class="material-symbols-outlined"> logout </span>
          <h3>Logout</h3>
        </a>
      </div>
    </aside>

    <main>
      <div style="text-align: center;">
        <h1 class="main-title" style="font-size: 3rem;">Manage Pets</h1>
        <div class="app">

          <main class="task-list">
            <table id="task-table">
              <thead>
                <tr>
                  <th>Pet Name</th>
                  <th>Pet Type</th>
                  <th>Breed</th>
                  <th>Age</th>
                  <th>Gender</th>
                  <th>Vaccination Status</th>
                  <th>Neutered</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody>
                <!-- EJS Loop to render pets dynamically -->
                <% pets.forEach(pet => { %>
                  <tr>
                    <td><%= pet.name %></td>
                    <td><%= pet.type %></td>
                    <td><%= pet.breed %></td>
                    <td><%= pet.age %></td>
                    <td><%= pet.gender %></td>
                    <td><%= pet.vaccination ? 'Yes' : 'No' %></td>
                    <td><%= pet.neutered ? 'Yes' : 'No' %></td>
                    <td class="action-button">
                      <!-- Delete button with an icon -->
                      <button class="btn-danger-custom" onclick="deletePet('<%= pet._id %>')" title="Delete Pet">
                        Delete
                      </button>
                    </td>
                  </tr>
                <% }); %>
              </tbody>
            </table>
          </main>
        </div>
      </div>
    </main>
  </div>

  <!-- JavaScript for DELETE method -->
  <script>
    function deletePet(petId) {
      if (confirm('Are you sure you want to delete this pet?')) {
        fetch(`/deletepet/${petId}`, {
          method: 'DELETE'
        })
        .then(response => {
          if (response.ok) {
            // If the delete request is successful, reload the page or navigate
            window.location.href = '/managepets';
          } else {
            alert('Error deleting the pet.');
          }
        })
        .catch(error => {
          console.error('Error:', error);
          alert('An error occurred while trying to delete the pet.');
        });
      }
    }

    // Logout functionality
    document.getElementById("logout-link").addEventListener("click", function (event) {
      event.preventDefault(); // Prevent the default anchor click behavior

      // Create a form element to send a POST request
      var form = document.createElement("form");
      form.method = "POST";
      form.action = "/logout";

      // Append the form to the body and submit it
      document.body.appendChild(form);
      form.submit();
    });
  </script>
</body>

</html>
